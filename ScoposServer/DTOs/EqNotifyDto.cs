// ============================================================================
// DTO (DATA TRANSFER OBJECT) ДЛЯ УВЕДОМЛЕНИЙ И СВЯЗАННОГО ОБОРУДОВАНИЯ
// ============================================================================

using System.ComponentModel.DataAnnotations;

namespace ScoposServer.DTOs;

// ============================================================================
// 1. DTO УВЕДОМЛЕНИЯ - ПОЛНАЯ ИНФОРМАЦИЯ
// ============================================================================

/// <summary>
/// DTO для отображения полной информации об уведомлении/дефекте
/// Используется в детальном просмотре, карточке уведомления, списках с фильтрацией
/// </summary>
public class EqNotifyDto
{
    // ========================================================================
    // 1.1 ИДЕНТИФИКАТОРЫ (ОБЯЗАТЕЛЬНЫЕ)
    // ========================================================================

    /// <summary>УНИКАЛЬНЫЙ КОД УВЕДОМЛЕНИЯ</summary>
    /// <remarks>Первичный ключ. Формат: NOT-XXX-ГГГГ. Пример: "NOT-001-2024"</remarks>
    public string QmCode { get; set; } = null!;

    /// <summary>КОД ФУНКЦИОНАЛЬНОГО ЭЛЕМЕНТА</summary>
    /// <remarks>Идентификатор ФЭ. Пример: "FE-COMP-01"</remarks>
    public string FeCode { get; set; } = null!;

    /// <summary>КОД ОБОРУДОВАНИЯ</summary>
    /// <remarks>Внешний ключ к EqEquipment. Пример: "EQ001"</remarks>
    public string EoCode { get; set; } = null!;

    // ========================================================================
    // 1.2 ТИП И КЛАССИФИКАЦИЯ
    // ========================================================================

    /// <summary>ТИП УВЕДОМЛЕНИЯ</summary>
    /// <remarks>Категория: "Техническое", "Промышленная безопасность"</remarks>
    public string? QmType { get; set; }

    /// <summary>ГРУППА УВЕДОМЛЕНИЯ</summary>
    /// <remarks>Пример: "Вибрация", "Утечки", "Температура"</remarks>
    public string? QmGrpName { get; set; }

    /// <summary>НАИМЕНОВАНИЕ ДЕФЕКТА</summary>
    /// <remarks>Описание неисправности. Пример: "Превышение вибрации"</remarks>
    public string? QmCodName { get; set; }

    /// <summary>ОРГАНИЗАЦИЯ</summary>
    /// <remarks>Кто выдал предписание. Пример: "Ростехнадзор", "ООО Технадзор"</remarks>
    public string? Organization { get; set; }

    /// <summary>НАИМЕНОВАНИЕ ФЭ</summary>
    /// <remarks>Конкретный узел. Пример: "Компрессор Н-101"</remarks>
    public string? FeName { get; set; }

    // ========================================================================
    // 1.3 СТАТУСЫ И ДАТЫ
    // ========================================================================

    /// <summary>КРИТИЧНОСТЬ</summary>
    /// <remarks>Уровень опасности: "Критический", "Высокий", "Средний", "Низкий"</remarks>
    public string? Criticality { get; set; }

    /// <summary>СТАТУС УСТРАНЕНИЯ</summary>
    /// <remarks>"В работе", "Устранен", "Просрочен", "Контроль"</remarks>
    public string? EliminationStatus { get; set; }

    /// <summary>ДАТА УСТРАНЕНИЯ</summary>
    /// <remarks>Фактическая или плановая дата устранения</remarks>
    public DateTime? EliminationDate { get; set; }

    /// <summary>СТАТУС РЕМОНТА</summary>
    /// <remarks>"Плановый ремонт", "Капитальный ремонт", "Завершен"</remarks>
    public string? RepairStatus { get; set; }

    /// <summary>НОМЕР ПРИКАЗА</summary>
    /// <remarks>Документ-основание. Пример: "ПР-124-24"</remarks>
    public string? OrderInfo { get; set; }

}

// ============================================================================
// 2. DTO ОБОРУДОВАНИЯ С ПОЛНЫМ СПИСКОМ УВЕДОМЛЕНИЙ
// ============================================================================

/// <summary>
/// DTO для отображения оборудования со всеми его уведомлениями
/// Используется в детальном просмотре оборудования (страница паспорта с уведомлениями)
/// </summary>
public class EquipmentWithNotifyDto
{
    // ========================================================================
    // 2.1 ИДЕНТИФИКАЦИЯ ОБОРУДОВАНИЯ
    // ========================================================================

    /// <summary>КОД 3D-МОДЕЛИ</summary>
    /// <remarks>Группировочный признак для визуализации. Пример: "MDL-1001"</remarks>
    public string ModelCode { get; set; } = null!;

    /// <summary>КОД ОБОРУДОВАНИЯ</summary>
    /// <remarks>Уникальный код единицы оборудования. Пример: "EQ001"</remarks>
    public string EquipmentCode { get; set; } = null!;

    /// <summary>НАИМЕНОВАНИЕ ОБОРУДОВАНИЯ</summary>
    /// <remarks>Пример: "Компрессор центробежный Н-101"</remarks>
    public string? EquipmentName { get; set; }

    // ========================================================================
    // 2.2 РАСПОЛОЖЕНИЕ
    // ========================================================================

    /// <summary>НАИМЕНОВАНИЕ ФИЛИАЛА</summary>
    /// <remarks>Пример: "Уфимский НПЗ"</remarks>
    public string? BranchName { get; set; }

    /// <summary>МЕСТОПОЛОЖЕНИЕ</summary>
    /// <remarks>Пример: "Цех №1 блок компрессии"</remarks>
    public string? Location { get; set; }

    // ========================================================================
    // 2.3 СТАТИСТИКА И ДАННЫЕ
    // ========================================================================

    /// <summary>КОЛИЧЕСТВО УВЕДОМЛЕНИЙ</summary>
    /// <remarks>Общее число уведомлений по данному оборудованию</remarks>
    public int NotifyCount { get; set; }

    /// <summary>СПИСОК УВЕДОМЛЕНИЙ</summary>
    /// <remarks>Полная коллекция всех уведомлений, привязанных к оборудованию</remarks>
    public List<EqNotifyDto> Notifies { get; set; } = new();
}

// ============================================================================
// 3. DTO ОБОРУДОВАНИЯ С КРАТКОЙ СТАТИСТИКОЙ ПО УВЕДОМЛЕНИЯМ
// ============================================================================

/// <summary>
/// DTO для отображения оборудования с агрегированной статистикой по уведомлениям
/// Используется в списках, таблицах, дашбордах и отчетах
/// </summary>
public class EquipmentWithNotifyShortDto
{
    // ========================================================================
    // 3.1 ИДЕНТИФИКАЦИЯ ОБОРУДОВАНИЯ
    // ========================================================================

    /// <summary>КОД 3D-МОДЕЛИ</summary>
    /// <remarks>Для группировки и фильтрации. Пример: "MDL-1001"</remarks>
    public string ModelCode { get; set; } = null!;

    /// <summary>КОД ОБОРУДОВАНИЯ</summary>
    /// <remarks>Уникальный идентификатор. Пример: "EQ001"</remarks>
    public string EquipmentCode { get; set; } = null!;

    /// <summary>НАИМЕНОВАНИЕ ОБОРУДОВАНИЯ</summary>
    /// <remarks>Отображается в списках. Пример: "Компрессор центробежный Н-101"</remarks>
    public string? EquipmentName { get; set; }

    // ========================================================================
    // 3.2 ХАРАКТЕРИСТИКИ
    // ========================================================================

    /// <summary>КЛАСС ОБОРУДОВАНИЯ</summary>
    /// <remarks>Для категоризации. Пример: "Компрессорное оборудование"</remarks>
    public string? ClassName { get; set; }

    /// <summary>ПРОИЗВОДИТЕЛЬ</summary>
    /// <remarks>Пример: "ОАО Казанькомпрессормаш"</remarks>
    public string? Manufacturer { get; set; }

    /// <summary>МЕСТОПОЛОЖЕНИЕ</summary>
    /// <remarks>Пример: "Цех №1 блок компрессии"</remarks>
    public string? Location { get; set; }

    // ========================================================================
    // 3.3 СТАТИСТИКА УВЕДОМЛЕНИЙ (АГРЕГИРОВАННАЯ)
    // ========================================================================

    /// <summary>ОБЩЕЕ КОЛИЧЕСТВО УВЕДОМЛЕНИЙ</summary>
    /// <remarks>Суммарное число всех уведомлений по оборудованию</remarks>
    public int NotifyCount { get; set; }

    /// <summary>КОЛИЧЕСТВО КРИТИЧЕСКИХ УВЕДОМЛЕНИЙ</summary>
    /// <remarks>Только с Criticality = "Критический". Для оценки рисков</remarks>
    public int CriticalCount { get; set; }

    /// <summary>ДАТА ПОСЛЕДНЕГО УВЕДОМЛЕНИЯ</summary>
    /// <remarks>Самое свежее уведомление. Для контроля актуальности</remarks>
    public DateTime? LastNotifyDate { get; set; }
}